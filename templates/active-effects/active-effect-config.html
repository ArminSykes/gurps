<form autocomplete='off'>
  <!-- Effect Header -->
  <header class='sheet-header'>
    <img class='effect-icon' src='{{system.icon}}' data-edit='icon' />
    <h1 class='effect-title'>{{ system.label }}</h1>
  </header>

  <!-- Effect Configuration Tabs -->
  <nav class='sheet-tabs tabs'>
    <a class='item' data-tab='details'><i class='fas fa-book'></i> {{i18n 'EFFECT.TabDetails'}}</a>
    <a class='item' data-tab='duration'><i class='fas fa-clock'></i> {{i18n 'EFFECT.TabDuration'}}</a>
    <a class='item' data-tab='effects'><i class='fas fa-cogs'></i> {{i18n 'EFFECT.TabEffects'}}</a>
  </nav>

  <!-- Details Tab -->
  <section class='tab' data-tab='details'>
    <div class='form-group'>
      <label for='label'>{{ localize 'EFFECT.Label' }}</label>
      <div class='form-fields'>
        <input id='label' type='text' name='label' value='{{ system.label }}' />
      </div>
    </div>

    <div class='form-group'>
      <label for='image'>{{ localize 'EFFECT.Icon' }}</label>
      <div class='form-fields'>
        {{filePicker target='icon' type='image'}}
        <input id='image' class='image' type='text' name='icon' placeholder='path/image.png' value='{{system.icon}}' />
      </div>
    </div>

    <div class='form-group'>
      <label for='color'>{{ localize 'EFFECT.IconTint' }}</label>
      <div id='color' class='form-fields'>
        <input class='color' type='text' name='tint' value='{{system.tint}}' />
        <input type='color' value='{{system.tint}}' data-edit='tint' />
      </div>
    </div>

    <div class='form-group'>
      <label for='disabled'>{{ localize 'EFFECT.Disabled' }}</label>
      <input id='disabled' type='checkbox' name='disabled' {{ checked system.disabled }} />
    </div>

    {{#if isActorEffect}}
    <div class='form-group'>
      <label for='origin'>{{ localize 'EFFECT.Origin' }}</label>
      <div class='form-fields'>
        <input id='origin' type='text' name='origin' value='{{ system.origin }}' disabled />
      </div>
    </div>
    {{/if}} {{#if isItemEffect}}
    <div class='form-group'>
      <label for='transfer'>{{ localize 'EFFECT.Transfer' }}</label>
      <div class='form-fields'>
        <input id='transfer' type='checkbox' name='transfer' {{checked system.transfer}} />
      </div>
    </div>
    {{/if}}
  </section>

  <!-- Duration Tab -->
  <section class='tab' data-tab='duration'>
    <div class='form-group'>
      <label>{{ localize 'EFFECT.DurationSecs' }}</label>
      <div class='form-fields'>
        <input type='number' name='duration.seconds' value='{{ system.duration.seconds }}' />
      </div>
    </div>
    <div class='form-group'>
      <label>{{ localize 'EFFECT.StartTime' }}</label>
      <div class='form-fields'>
        <input type='number' name='duration.startTime' value='{{ system.duration.startTime }}' />
      </div>
    </div>
    <hr />
    <div class='form-group'>
      <label>{{i18n 'GURPS.effectsTermination'}}</label>
      <div class='form-fields'>
        <input type='text' name='flags.gurps.endCondition' value='{{ system.flags.gurps.endCondition }}' />
      </div>
    </div>
    <hr />
    <div class='form-group'>
      <label>{{ localize 'EFFECT.DurationTurns' }}</label>
      <div class='form-fields'>
        <label>{{ localize 'COMBAT.Rounds' }}</label>
        <input type='number' name='duration.rounds' value='{{ system.duration.rounds }}' />
        <label>{{ localize 'COMBAT.Turns' }}</label>
        <input type='number' name='duration.turns' value='{{ system.duration.turns }}' />
      </div>
    </div>
    <div class='form-group'>
      <label>{{ localize 'EFFECT.Combat' }}</label>
      <div class='form-fields'>
        <input type='text' name='duration.combat' value='{{ system.duration.combat }}' disabled />
      </div>
    </div>

    <div class='form-group'>
      <label>{{ localize 'EFFECT.StartTurns' }}</label>
      <div class='form-fields'>
        <label>{{ localize 'COMBAT.Round' }}</label>
        <input type='number' name='duration.startRound' value='{{ system.duration.startRound }}' />
        <label>{{ localize 'COMBAT.Turn' }}</label>
        <input type='number' name='duration.startTurn' value='{{ system.duration.startTurn }}' />
      </div>
    </div>
  </section>

  <!-- Effects Tab -->
  <section class='tab' data-tab='effects'>
    <header class='effect-change effects-header flexrow'>
      <div class='key'>{{ localize 'EFFECT.ChangeKey' }}</div>
      <div class='mode'>{{ localize 'EFFECT.ChangeMode' }}</div>
      <div class='value'>{{ localize 'EFFECT.ChangeValue' }}</div>
      <div class='effect-controls'>
        <a class='effect-control' data-action='add'><i class='far fa-plus-square'></i></a>
      </div>
    </header>
    <ol class='changes-list'>
      {{#each system.changes as |change i|}}
      <li class='effect-change flexrow' data-index='{{i}}'>
        <div class='key'>
          <select name='changes.{{i}}.key'>
            {{selectOptions ../changes selected=change.key localize=true}}
          </select>
        </div>
        <div class='mode'>
          <select name='changes.{{i}}.mode' data-dtype='Number'>
            {{selectOptions ../modes selected=change.mode}}
          </select>
        </div>
        <div class='value'>
          <input type='text' name='changes.{{i}}.value' value='{{change.value}}' />
        </div>
        <div class='effect-controls'>
          <a class='effect-control' data-action='delete'><i class='fas fa-trash'></i></a>
        </div>
      </li>
      {{/each}}
    </ol>
  </section>

  <footer class='sheet-footer'>
    <button type='submit'><i class='fas fa-save'></i> {{i18n submitText}}</button>
  </footer>
</form>